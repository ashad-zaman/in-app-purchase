<?php
/**
 * Summary of ApplePriceTierHelper
 */
class ApplePriceTierHelper
{
    /**
     * Apple Price Tier Matrix .
     * This is a simplified list. Expandable to full 900 tiers by pulling from Apple CSV.
     */

    // private $prices=(new Product_Price_Finder())->getApplePriceList();
    private static $tiers =[
                        0 => 'Tier_0',
                        0.29 => 'Tier_1',
                        0.39 => 'Tier_2',
                        0.49 => 'Tier_3',
                        0.59 => 'Tier_4',
                        0.69 => 'Tier_5',
                        0.79 => 'Tier_6',
                        0.89 => 'Tier_7',
                        0.9 => 'Tier_8',
                        0.95 => 'Tier_9',
                        0.99 => 'Tier_10',
                        1 => 'Tier_11',
                        1.09 => 'Tier_12',
                        1.19 => 'Tier_13',
                        1.29 => 'Tier_14',
                        1.39 => 'Tier_15',
                        1.49 => 'Tier_16',
                        1.59 => 'Tier_17',
                        1.69 => 'Tier_18',
                        1.79 => 'Tier_19',
                        1.89 => 'Tier_20',
                        1.9 => 'Tier_21',
                        1.95 => 'Tier_22',
                        1.99 => 'Tier_23',
                        2 => 'Tier_24',
                        2.09 => 'Tier_25',
                        2.19 => 'Tier_26',
                        2.29 => 'Tier_27',
                        2.39 => 'Tier_28',
                        2.49 => 'Tier_29',
                        2.59 => 'Tier_30',
                        2.69 => 'Tier_31',
                        2.79 => 'Tier_32',
                        2.89 => 'Tier_33',
                        2.9 => 'Tier_34',
                        2.95 => 'Tier_35',
                        2.99 => 'Tier_36',
                        3 => 'Tier_37',
                        3.09 => 'Tier_38',
                        3.19 => 'Tier_39',
                        3.29 => 'Tier_40',
                        3.39 => 'Tier_41',
                        3.49 => 'Tier_42',
                        3.59 => 'Tier_43',
                        3.69 => 'Tier_44',
                        3.79 => 'Tier_45',
                        3.89 => 'Tier_46',
                        3.9 => 'Tier_47',
                        3.95 => 'Tier_48',
                        3.99 => 'Tier_49',
                        4 => 'Tier_50',
                        4.09 => 'Tier_51',
                        4.19 => 'Tier_52',
                        4.29 => 'Tier_53',
                        4.39 => 'Tier_54',
                        4.49 => 'Tier_55',
                        4.59 => 'Tier_56',
                        4.69 => 'Tier_57',
                        4.79 => 'Tier_58',
                        4.89 => 'Tier_59',
                        4.9 => 'Tier_60',
                        4.95 => 'Tier_61',
                        4.99 => 'Tier_62',
                        5 => 'Tier_63',
                        5.09 => 'Tier_64',
                        5.19 => 'Tier_65',
                        5.29 => 'Tier_66',
                        5.39 => 'Tier_67',
                        5.49 => 'Tier_68',
                        5.59 => 'Tier_69',
                        5.69 => 'Tier_70',
                        5.79 => 'Tier_71',
                        5.89 => 'Tier_72',
                        5.9 => 'Tier_73',
                        5.95 => 'Tier_74',
                        5.99 => 'Tier_75',
                        6 => 'Tier_76',
                        6.09 => 'Tier_77',
                        6.19 => 'Tier_78',
                        6.29 => 'Tier_79',
                        6.39 => 'Tier_80',
                        6.49 => 'Tier_81',
                        6.59 => 'Tier_82',
                        6.69 => 'Tier_83',
                        6.79 => 'Tier_84',
                        6.89 => 'Tier_85',
                        6.9 => 'Tier_86',
                        6.95 => 'Tier_87',
                        6.99 => 'Tier_88',
                        7 => 'Tier_89',
                        7.09 => 'Tier_90',
                        7.19 => 'Tier_91',
                        7.29 => 'Tier_92',
                        7.39 => 'Tier_93',
                        7.49 => 'Tier_94',
                        7.59 => 'Tier_95',
                        7.69 => 'Tier_96',
                        7.79 => 'Tier_97',
                        7.89 => 'Tier_98',
                        7.9 => 'Tier_99',
                        7.95 => 'Tier_100',
                        7.99 => 'Tier_101',
                        8 => 'Tier_102',
                        8.09 => 'Tier_103',
                        8.19 => 'Tier_104',
                        8.29 => 'Tier_105',
                        8.39 => 'Tier_106',
                        8.49 => 'Tier_107',
                        8.59 => 'Tier_108',
                        8.69 => 'Tier_109',
                        8.79 => 'Tier_110',
                        8.89 => 'Tier_111',
                        8.9 => 'Tier_112',
                        8.95 => 'Tier_113',
                        8.99 => 'Tier_114',
                        9 => 'Tier_115',
                        9.09 => 'Tier_116',
                        9.19 => 'Tier_117',
                        9.29 => 'Tier_118',
                        9.39 => 'Tier_119',
                        9.49 => 'Tier_120',
                        9.59 => 'Tier_121',
                        9.69 => 'Tier_122',
                        9.79 => 'Tier_123',
                        9.89 => 'Tier_124',
                        9.9 => 'Tier_125',
                        9.95 => 'Tier_126',
                        9.99 => 'Tier_127',
                        10 => 'Tier_128',
                        10.49 => 'Tier_129',
                        10.9 => 'Tier_130',
                        10.95 => 'Tier_131',
                        10.99 => 'Tier_132',
                        11 => 'Tier_133',
                        11.49 => 'Tier_134',
                        11.9 => 'Tier_135',
                        11.95 => 'Tier_136',
                        11.99 => 'Tier_137',
                        12 => 'Tier_138',
                        12.49 => 'Tier_139',
                        12.9 => 'Tier_140',
                        12.95 => 'Tier_141',
                        12.99 => 'Tier_142',
                        13 => 'Tier_143',
                        13.49 => 'Tier_144',
                        13.9 => 'Tier_145',
                        13.95 => 'Tier_146',
                        13.99 => 'Tier_147',
                        14 => 'Tier_148',
                        14.49 => 'Tier_149',
                        14.9 => 'Tier_150',
                        14.95 => 'Tier_151',
                        14.99 => 'Tier_152',
                        15 => 'Tier_153',
                        15.49 => 'Tier_154',
                        15.9 => 'Tier_155',
                        15.95 => 'Tier_156',
                        15.99 => 'Tier_157',
                        16 => 'Tier_158',
                        16.49 => 'Tier_159',
                        16.9 => 'Tier_160',
                        16.95 => 'Tier_161',
                        16.99 => 'Tier_162',
                        17 => 'Tier_163',
                        17.49 => 'Tier_164',
                        17.9 => 'Tier_165',
                        17.95 => 'Tier_166',
                        17.99 => 'Tier_167',
                        18 => 'Tier_168',
                        18.49 => 'Tier_169',
                        18.9 => 'Tier_170',
                        18.95 => 'Tier_171',
                        18.99 => 'Tier_172',
                        19 => 'Tier_173',
                        19.49 => 'Tier_174',
                        19.9 => 'Tier_175',
                        19.95 => 'Tier_176',
                        19.99 => 'Tier_177',
                        20 => 'Tier_178',
                        20.49 => 'Tier_179',
                        20.9 => 'Tier_180',
                        20.95 => 'Tier_181',
                        20.99 => 'Tier_182',
                        21 => 'Tier_183',
                        21.49 => 'Tier_184',
                        21.9 => 'Tier_185',
                        21.95 => 'Tier_186',
                        21.99 => 'Tier_187',
                        22 => 'Tier_188',
                        22.49 => 'Tier_189',
                        22.9 => 'Tier_190',
                        22.95 => 'Tier_191',
                        22.99 => 'Tier_192',
                        23 => 'Tier_193',
                        23.49 => 'Tier_194',
                        23.9 => 'Tier_195',
                        23.95 => 'Tier_196',
                        23.99 => 'Tier_197',
                        24 => 'Tier_198',
                        24.49 => 'Tier_199',
                        24.9 => 'Tier_200',
                        24.95 => 'Tier_201',
                        24.99 => 'Tier_202',
                        25 => 'Tier_203',
                        25.49 => 'Tier_204',
                        25.9 => 'Tier_205',
                        25.95 => 'Tier_206',
                        25.99 => 'Tier_207',
                        26 => 'Tier_208',
                        26.49 => 'Tier_209',
                        26.9 => 'Tier_210',
                        26.95 => 'Tier_211',
                        26.99 => 'Tier_212',
                        27 => 'Tier_213',
                        27.49 => 'Tier_214',
                        27.9 => 'Tier_215',
                        27.95 => 'Tier_216',
                        27.99 => 'Tier_217',
                        28 => 'Tier_218',
                        28.49 => 'Tier_219',
                        28.9 => 'Tier_220',
                        28.95 => 'Tier_221',
                        28.99 => 'Tier_222',
                        29 => 'Tier_223',
                        29.49 => 'Tier_224',
                        29.9 => 'Tier_225',
                        29.95 => 'Tier_226',
                        29.99 => 'Tier_227',
                        30 => 'Tier_228',
                        30.49 => 'Tier_229',
                        30.9 => 'Tier_230',
                        30.95 => 'Tier_231',
                        30.99 => 'Tier_232',
                        31 => 'Tier_233',
                        31.49 => 'Tier_234',
                        31.9 => 'Tier_235',
                        31.95 => 'Tier_236',
                        31.99 => 'Tier_237',
                        32 => 'Tier_238',
                        32.49 => 'Tier_239',
                        32.9 => 'Tier_240',
                        32.95 => 'Tier_241',
                        32.99 => 'Tier_242',
                        33 => 'Tier_243',
                        33.49 => 'Tier_244',
                        33.9 => 'Tier_245',
                        33.95 => 'Tier_246',
                        33.99 => 'Tier_247',
                        34 => 'Tier_248',
                        34.49 => 'Tier_249',
                        34.9 => 'Tier_250',
                        34.95 => 'Tier_251',
                        34.99 => 'Tier_252',
                        35 => 'Tier_253',
                        35.49 => 'Tier_254',
                        35.9 => 'Tier_255',
                        35.95 => 'Tier_256',
                        35.99 => 'Tier_257',
                        36 => 'Tier_258',
                        36.49 => 'Tier_259',
                        36.9 => 'Tier_260',
                        36.95 => 'Tier_261',
                        36.99 => 'Tier_262',
                        37 => 'Tier_263',
                        37.49 => 'Tier_264',
                        37.9 => 'Tier_265',
                        37.95 => 'Tier_266',
                        37.99 => 'Tier_267',
                        38 => 'Tier_268',
                        38.49 => 'Tier_269',
                        38.9 => 'Tier_270',
                        38.95 => 'Tier_271',
                        38.99 => 'Tier_272',
                        39 => 'Tier_273',
                        39.49 => 'Tier_274',
                        39.9 => 'Tier_275',
                        39.95 => 'Tier_276',
                        39.99 => 'Tier_277',
                        40 => 'Tier_278',
                        40.49 => 'Tier_279',
                        40.9 => 'Tier_280',
                        40.95 => 'Tier_281',
                        40.99 => 'Tier_282',
                        41 => 'Tier_283',
                        41.49 => 'Tier_284',
                        41.9 => 'Tier_285',
                        41.95 => 'Tier_286',
                        41.99 => 'Tier_287',
                        42 => 'Tier_288',
                        42.49 => 'Tier_289',
                        42.9 => 'Tier_290',
                        42.95 => 'Tier_291',
                        42.99 => 'Tier_292',
                        43 => 'Tier_293',
                        43.49 => 'Tier_294',
                        43.9 => 'Tier_295',
                        43.95 => 'Tier_296',
                        43.99 => 'Tier_297',
                        44 => 'Tier_298',
                        44.49 => 'Tier_299',
                        44.9 => 'Tier_300',
                        44.95 => 'Tier_301',
                        44.99 => 'Tier_302',
                        45 => 'Tier_303',
                        45.49 => 'Tier_304',
                        45.9 => 'Tier_305',
                        45.95 => 'Tier_306',
                        45.99 => 'Tier_307',
                        46 => 'Tier_308',
                        46.49 => 'Tier_309',
                        46.9 => 'Tier_310',
                        46.95 => 'Tier_311',
                        46.99 => 'Tier_312',
                        47 => 'Tier_313',
                        47.49 => 'Tier_314',
                        47.9 => 'Tier_315',
                        47.95 => 'Tier_316',
                        47.99 => 'Tier_317',
                        48 => 'Tier_318',
                        48.49 => 'Tier_319',
                        48.9 => 'Tier_320',
                        48.95 => 'Tier_321',
                        48.99 => 'Tier_322',
                        49 => 'Tier_323',
                        49.49 => 'Tier_324',
                        49.9 => 'Tier_325',
                        49.95 => 'Tier_326',
                        49.99 => 'Tier_327',
                        50 => 'Tier_328'
                    ];

    /**
     * Get Apple Price Tier for a given raw   price.
     *
     * @param float $price
     * @return array
     */
    public static function mapPriceToTier($price)
    {
        $price = round($price, 2);

        if (isset(self::$tiers[$price])) {
            return self::$tiers[$price]; 
        }

        // Find closest available tier
        $closest = null;
        $minDiff = PHP_INT_MAX;
        foreach (self::$tiers as $tierPrice => $tierName) {
            $diff = abs($tierPrice - $price);
            if ($diff < $minDiff) {
                $minDiff = $diff;
                 $closest = $tierName;
                // $closest = [
                //     'success' => false,
                //     'price'   => $price,
                //     'tier'    => $tierName,
                //     'closestPrice' => $tierPrice,
                // ];
            }
        } 

        return  $closest;
    }

    /**
     * List all defined tiers.
     *
     * @return array
     */
    public static function listTiers()
    {
        return self::$tiers;
    }
}

// Example usage:
// $result = ApplePriceTierHelper::mapPriceToTier(5.89);
// print_r($result);

